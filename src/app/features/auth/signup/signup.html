<div class="auth-shell"> 
  <div class="auth-frame">
    <main class="form-pane only-form">
      <div class="brand">
        <img class="brand-mark" src="https://ik.imagekit.io/a2wpi1kd9/imgToUrl/image-to-url_HEow9eLbR" alt="Medtik" />
        <h1>Medtik</h1>
      </div>

      <h2>Create your account</h2>

      <form [formGroup]="form" (ngSubmit)="submit()">
        <mat-form-field appearance="outline">
          <mat-label>Full name</mat-label>
          <input matInput formControlName="fullName" autocomplete="name" />
          <mat-error *ngIf="f.fullName.touched && f.fullName.errors?.['required']">Full name is required</mat-error>
          <mat-error *ngIf="f.fullName.touched && f.fullName.errors?.['minlength']">At least 3 characters</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input matInput type="email" formControlName="email" autocomplete="email" />
          <mat-icon matSuffix>mail</mat-icon>
          <mat-error *ngIf="f.email.touched && f.email.errors?.['required']">Email is required</mat-error>
          <mat-error *ngIf="f.email.touched && f.email.errors?.['email']">Enter a valid email</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Password</mat-label>
          <input matInput [type]="hide ? 'password' : 'text'" formControlName="password" autocomplete="new-password" />
          <button mat-icon-button matSuffix type="button" (click)="hide = !hide" aria-label="Toggle password">
            <mat-icon>{{ hide ? 'visibility' : 'visibility_off' }}</mat-icon>
          </button>
          <mat-error *ngIf="f.password.touched && f.password.errors?.['required']">Password is required</mat-error>
          <mat-error *ngIf="f.password.touched && f.password.errors?.['minlength']">Min 6 characters</mat-error>
        </mat-form-field>

        <!-- Birthdate: Material datepicker -->
                <mat-form-field appearance="outline">
                  <mat-label>Birthdate</mat-label>
                  <input matInput [matDatepicker]="picker" formControlName="birthdate" [max]="today"/>
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker [startAt]="startAt"></mat-datepicker>
                  <mat-error *ngIf="f.birthdate.touched && f.birthdate.errors?.['required']">Birthdate is required</mat-error>
                </mat-form-field>

        <!-- Gender: Material select -->
        <mat-form-field appearance="outline">
          <mat-label>Gender</mat-label>
          <mat-select formControlName="gender">
            <mat-option *ngFor="let g of genders" [value]="g">{{ g }}</mat-option>
          </mat-select>
          <mat-error *ngIf="f.gender.touched && f.gender.errors?.['required']">Gender is required</mat-error>
        </mat-form-field>

        <!-- Country select with emoji in trigger and options -->
        <mat-form-field appearance="outline">
          <mat-label>Country</mat-label>
          <mat-select formControlName="country" (selectionChange)="onCountryChange($event.value)">
            <mat-select-trigger>
              <span class="flag">{{ selectedCountry?.flag }}</span>
              {{ selectedCountry?.name }}
              <span class="dial-option">{{ selectedDial }}</span>
            </mat-select-trigger>

            <mat-option *ngFor="let c of countries" [value]="c.name">
              <span class="flag">{{ c.flag }}</span>
              {{ c.name }}
              <span class="dial-option">{{ c.dial }}</span>
            </mat-option>
          </mat-select>
          <mat-error *ngIf="f.country.touched && f.country.errors?.['required']">Country is required</mat-error>
        </mat-form-field>

        <!-- Phone with auto country code prefix -->
        <mat-form-field appearance="outline">
          <mat-label>Phone number</mat-label>
          <span matPrefix class="dial">{{ selectedDial }}</span>
          <input matInput formControlName="phoneLocal" autocomplete="tel" placeholder="1234567890" />
          <mat-error *ngIf="f.phoneLocal.touched && f.phoneLocal.errors?.['required']">Phone is required</mat-error>
          <mat-error *ngIf="f.phoneLocal.touched && f.phoneLocal.errors?.['pattern']">Digits only, 6â€“14</mat-error>
        </mat-form-field>

        <button mat-flat-button color="primary" class="submit" type="submit">
          Create account
        </button>

        <div class="Already-have-account">
          <span>Already have an account?</span>
          <button mat-button color="primary" (click)="AlreadyExist()">Log in</button>
        </div>
      </form>
    </main>
  </div>
</div>
